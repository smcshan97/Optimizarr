diff --git a/web/static/js/app.js b/web/static/js/app.js
index 589c4d4..bf8a810 100644
--- a/web/static/js/app.js
+++ b/web/static/js/app.js
@@ -224,10 +224,21 @@ async function loadQueue() {
     }
 }
 
+// Debounce utility
+function debounce(fn, delay) {
+    let timer;
+    return function(...args) {
+        clearTimeout(timer);
+        timer = setTimeout(() => fn.apply(this, args), delay);
+    };
+}
+
+const debouncedFilterQueue = debounce(() => filterQueue(), 300);
+
 // Filter queue by search and status, then sort and display
 function filterQueue() {
-    const searchTerm = (document.getElementById('queueSearch')?.value || '').toLowerCase();
-    const statusFilter = document.getElementById('queueStatusFilter')?.value || '';
+    const searchTerm = (document.getElementById('queueSearchInput')?.value || '').toLowerCase();
+    const statusFilter = document.getElementById('queueFilterStatus')?.value || '';
     
     let filtered = allQueueItems;
     
@@ -309,6 +320,8 @@ function toggleSort(field) {
     }
     filterQueue();
 }
+// Alias for HTML onclick references
+const sortQueue = toggleSort;
 
 // Get sort arrow indicator
 function sortArrow(field) {
@@ -336,10 +349,15 @@ function formatSize(bytes) {
 
 // Select All / Deselect All
 function toggleSelectAll(checkbox) {
+    // Handle being called from HTML without argument
+    if (!checkbox || !(checkbox instanceof HTMLInputElement)) {
+        checkbox = document.getElementById('queueHeaderCheck') || document.getElementById('selectAllQueue');
+    }
     const checkboxes = document.querySelectorAll('.queue-row-checkbox');
     selectedQueueIds.clear();
     
-    if (checkbox.checked) {
+    const isChecked = checkbox ? checkbox.checked : false;
+    if (isChecked) {
         checkboxes.forEach(cb => {
             cb.checked = true;
             selectedQueueIds.add(parseInt(cb.dataset.id));
@@ -357,21 +375,25 @@ function toggleRowSelect(checkbox, id) {
         selectedQueueIds.delete(id);
     }
     
-    // Update select-all checkbox state
+    // Update select-all checkbox state (both toolbar and table header)
     const allBoxes = document.querySelectorAll('.queue-row-checkbox');
-    const selectAllBox = document.getElementById('selectAllCheckbox');
-    if (selectAllBox) {
-        selectAllBox.checked = selectedQueueIds.size === allBoxes.length && allBoxes.length > 0;
-        selectAllBox.indeterminate = selectedQueueIds.size > 0 && selectedQueueIds.size < allBoxes.length;
-    }
+    ['queueHeaderCheck', 'selectAllQueue'].forEach(id => {
+        const box = document.getElementById(id);
+        if (box) {
+            box.checked = selectedQueueIds.size === allBoxes.length && allBoxes.length > 0;
+            box.indeterminate = selectedQueueIds.size > 0 && selectedQueueIds.size < allBoxes.length;
+        }
+    });
     updateBulkBar();
 }
 
 function deselectAll() {
     selectedQueueIds.clear();
     document.querySelectorAll('.queue-row-checkbox').forEach(cb => cb.checked = false);
-    const selectAllBox = document.getElementById('selectAllCheckbox');
-    if (selectAllBox) { selectAllBox.checked = false; selectAllBox.indeterminate = false; }
+    ['queueHeaderCheck', 'selectAllQueue'].forEach(id => {
+        const box = document.getElementById(id);
+        if (box) { box.checked = false; box.indeterminate = false; }
+    });
     updateBulkBar();
 }
 
@@ -379,12 +401,60 @@ function updateBulkBar() {
     const bar = document.getElementById('bulkActionsBar');
     const countEl = document.getElementById('bulkSelectedCount');
     
+    if (!bar) return;
+    
     if (selectedQueueIds.size > 0) {
         bar.classList.remove('hidden');
-        countEl.textContent = `${selectedQueueIds.size} item${selectedQueueIds.size > 1 ? 's' : ''} selected`;
+        bar.style.display = 'flex';
+        if (countEl) countEl.textContent = selectedQueueIds.size;
     } else {
         bar.classList.add('hidden');
+        bar.style.display = '';
+    }
+}
+
+function clearSelection() {
+    selectedQueueIds.clear();
+    document.querySelectorAll('.queue-row-checkbox').forEach(cb => cb.checked = false);
+    const headerCheck = document.getElementById('queueHeaderCheck');
+    const selectAll = document.getElementById('selectAllQueue');
+    if (headerCheck) headerCheck.checked = false;
+    if (selectAll) selectAll.checked = false;
+    updateBulkBar();
+}
+
+async function bulkAction(action) {
+    if (selectedQueueIds.size === 0) {
+        showMessage('No items selected', 'warning');
+        return;
+    }
+    
+    if (action === 'delete') {
+        if (!confirm(`Delete ${selectedQueueIds.size} selected item(s)?`)) return;
+        let count = 0;
+        for (const id of selectedQueueIds) {
+            const result = await apiRequest(`/queue/${id}`, { method: 'DELETE' });
+            if (result) count++;
+        }
+        selectedQueueIds.clear();
+        showMessage(`Deleted ${count} item(s)`, 'success');
+    } else {
+        const statusMap = { retry: 'pending', pause: 'paused', resume: 'pending' };
+        const newStatus = statusMap[action];
+        if (!newStatus) { showMessage('Unknown action: ' + action, 'error'); return; }
+        
+        let count = 0;
+        for (const id of selectedQueueIds) {
+            const result = await apiRequest(`/queue/${id}`, {
+                method: 'PATCH',
+                body: JSON.stringify({ status: newStatus })
+            });
+            if (result) count++;
+        }
+        showMessage(`${action === 'retry' ? 'Retried' : action === 'pause' ? 'Paused' : 'Resumed'} ${count} item(s)`, 'success');
     }
+    deselectAll();
+    loadQueue();
 }
 
 async function bulkDeleteSelected() {
@@ -416,7 +486,8 @@ function displayQueueItems(items) {
 
     if (!items || items.length === 0) {
         container.innerHTML = '<p class="text-gray-400">No items in queue. Click "Scan All" to find media files.</p>';
-        document.getElementById('bulkActionsBar').classList.add('hidden');
+        const bar = document.getElementById('bulkActionsBar');
+        if (bar) bar.classList.add('hidden');
         return;
     }
 
@@ -604,13 +675,15 @@ function displayQueueItems(items) {
     html += '</tbody></table>';
     container.innerHTML = html;
     
-    // Restore selection state on select-all checkbox
-    const selectAllBox = document.getElementById('selectAllCheckbox');
-    if (selectAllBox) {
-        const allBoxes = document.querySelectorAll('.queue-row-checkbox');
-        selectAllBox.checked = selectedQueueIds.size === allBoxes.length && allBoxes.length > 0;
-        selectAllBox.indeterminate = selectedQueueIds.size > 0 && selectedQueueIds.size < allBoxes.length;
-    }
+    // Restore selection state on select-all checkboxes
+    ['queueHeaderCheck', 'selectAllQueue'].forEach(id => {
+        const box = document.getElementById(id);
+        if (box) {
+            const allBoxes = document.querySelectorAll('.queue-row-checkbox');
+            box.checked = selectedQueueIds.size === allBoxes.length && allBoxes.length > 0;
+            box.indeterminate = selectedQueueIds.size > 0 && selectedQueueIds.size < allBoxes.length;
+        }
+    });
     updateBulkBar();
 }
 
@@ -632,6 +705,7 @@ async function stopEncoding() {
 }
 
 // Initialize
+let _statsRefreshInterval = null;
 document.addEventListener('DOMContentLoaded', () => {
     // Check auth
     if (!checkAuth()) return;
@@ -646,16 +720,17 @@ document.addEventListener('DOMContentLoaded', () => {
     loadResources();
     loadQueue();
     
-    // Auto-refresh every 5 seconds
-    setInterval(() => {
+    // Auto-refresh stats/resources every 5 seconds (pauses when tab hidden)
+    _statsRefreshInterval = setInterval(() => {
+        if (document.hidden) return; // Skip refresh when tab not visible
         loadStats();
         loadResources();
-        // Only refresh queue if queue tab is active
-        const queuePanel = document.getElementById('tab-queue');
-        if (queuePanel && queuePanel.classList.contains('active')) {
-            loadQueue();
-        }
     }, 5000);
+    
+    // Initialize queue auto-refresh from checkbox state
+    if (document.getElementById('autoRefreshQueue')?.checked) {
+        toggleAutoRefresh();
+    }
 });
 
 // Settings functions
@@ -720,15 +795,15 @@ function applyPreset(preset) {
     
     const config = presets[preset];
     if (config) {
-        document.getElementById('cpuThreshold').value = config.cpu;
-        document.getElementById('memoryThreshold').value = config.memory;
-        document.getElementById('gpuThreshold').value = config.gpu;
-        document.getElementById('niceLevel').value = config.nice;
+        const el = (id) => document.getElementById(id);
+        if (el('cpuThreshold')) el('cpuThreshold').value = config.cpu;
+        if (el('memoryThreshold')) el('memoryThreshold').value = config.memory;
+        if (el('gpuThreshold')) el('gpuThreshold').value = config.gpu;
+        if (el('niceLevel')) el('niceLevel').value = config.nice;
     }
 }
 
 // Schedule management
-let selectedDays = new Set([0, 1, 2, 3, 4, 5, 6]); // All days selected by default
 
 async function loadSchedule() {
     const schedule = await apiRequest('/schedule');
@@ -738,52 +813,46 @@ async function loadSchedule() {
         // Set enabled state
         document.getElementById('scheduleEnabled').checked = config.enabled;
         
-        // Set days
-        selectedDays = new Set(config.days_of_week.split(',').map(d => parseInt(d)));
-        updateDayButtons();
-        
-        // Set times
-        document.getElementById('startTime').value = config.start_time;
-        document.getElementById('endTime').value = config.end_time;
+        // Set days - handle both numeric and string day formats
+        const daysStr = config.days_of_week || '';
+        const dayMap = { 'mon': 0, 'tue': 1, 'wed': 2, 'thu': 3, 'fri': 4, 'sat': 5, 'sun': 6 };
         
-        // Update status
-        document.getElementById('scheduleStatus').textContent = config.enabled ? '‚úì Enabled' : '‚úó Disabled';
-        document.getElementById('scheduleStatus').className = config.enabled ? 'ml-2 font-medium text-green-400' : 'ml-2 font-medium text-gray-400';
+        // Update day checkboxes in HTML
+        const dayContainer = document.getElementById('scheduleDays');
+        if (dayContainer) {
+            const checkboxes = dayContainer.querySelectorAll('input[type="checkbox"]');
+            const activeDays = daysStr.split(',').map(d => d.trim().toLowerCase());
+            checkboxes.forEach(cb => {
+                cb.checked = activeDays.includes(cb.value);
+            });
+        }
         
-        document.getElementById('withinWindow').textContent = schedule.within_schedule ? '‚úì Yes' : '‚úó No';
-        document.getElementById('withinWindow').className = schedule.within_schedule ? 'ml-2 font-medium text-green-400' : 'ml-2 font-medium text-gray-400';
+        // Set times
+        const startEl = document.getElementById('scheduleStart');
+        const endEl = document.getElementById('scheduleEnd');
+        if (startEl) startEl.value = config.start_time || '22:00';
+        if (endEl) endEl.value = config.end_time || '06:00';
         
-        document.getElementById('manualOverride').textContent = schedule.manual_override ? '‚úì Active' : '‚úó Inactive';
-        document.getElementById('manualOverride').className = schedule.manual_override ? 'ml-2 font-medium text-yellow-400' : 'ml-2 font-medium text-gray-400';
+        // Set Windows Active Hours
+        const activeHoursEl = document.getElementById('scheduleActiveHours');
+        if (activeHoursEl) activeHoursEl.checked = config.respect_active_hours || false;
     }
 }
 
-function toggleDay(day) {
-    if (selectedDays.has(day)) {
-        selectedDays.delete(day);
-    } else {
-        selectedDays.add(day);
-    }
-    updateDayButtons();
-}
-
-function updateDayButtons() {
-    for (let i = 0; i < 7; i++) {
-        const btn = document.getElementById(`day-${i}`);
-        if (selectedDays.has(i)) {
-            btn.className = 'day-button day-button-active';
-        } else {
-            btn.className = 'day-button';
-        }
-    }
-}
+// Day checkboxes are handled directly in HTML, no toggle/button code needed
 
 async function saveSchedule() {
+    // Gather selected days from checkboxes
+    const dayContainer = document.getElementById('scheduleDays');
+    const dayCheckboxes = dayContainer ? dayContainer.querySelectorAll('input[type="checkbox"]:checked') : [];
+    const daysStr = Array.from(dayCheckboxes).map(cb => cb.value).join(',');
+    
     const config = {
         enabled: document.getElementById('scheduleEnabled').checked,
-        days_of_week: Array.from(selectedDays).sort().join(','),
-        start_time: document.getElementById('startTime').value,
-        end_time: document.getElementById('endTime').value,
+        days_of_week: daysStr,
+        start_time: document.getElementById('scheduleStart').value,
+        end_time: document.getElementById('scheduleEnd').value,
+        respect_active_hours: document.getElementById('scheduleActiveHours')?.checked || false,
         timezone: 'UTC'
     };
     
@@ -793,14 +862,7 @@ async function saveSchedule() {
     });
     
     if (result) {
-        const msgEl = document.getElementById('scheduleMessage');
-        msgEl.textContent = '‚úì Schedule saved successfully';
-        msgEl.className = 'mt-4 p-3 bg-green-900/50 border border-green-700 rounded text-green-300';
-        msgEl.classList.remove('hidden');
-        
-        setTimeout(() => msgEl.classList.add('hidden'), 3000);
-        
-        // Reload schedule to update status
+        showMessage('Schedule saved successfully', 'success');
         loadSchedule();
     }
 }
@@ -878,7 +940,8 @@ function showCreateProfileForm() {
     // Reset Phase 2 fields to defaults
     document.getElementById('profileAudioHandling').value = 'preserve_all';
     document.getElementById('profileSubtitleHandling').value = 'none';
-    document.getElementById('profileEnableFilters').checked = false;
+    const enableFiltersEl = document.getElementById('profileEnableFilters');
+    if (enableFiltersEl) enableFiltersEl.checked = false;
     document.getElementById('profileChapterMarkers').checked = true;
     document.getElementById('profileHwAccel').checked = false;
     document.getElementById('profileContainer').value = 'mkv';
@@ -931,12 +994,14 @@ async function editProfile(id) {
     document.getElementById('profileAudioCodec').value = profile.audio_codec;
     document.getElementById('profileAudioHandling').value = profile.audio_handling || 'preserve_all';
     document.getElementById('profileSubtitleHandling').value = profile.subtitle_handling || 'none';
-    document.getElementById('profileEnableFilters').checked = profile.enable_filters || false;
+    const enableFiltersEdit = document.getElementById('profileEnableFilters');
+    if (enableFiltersEdit) enableFiltersEdit.checked = profile.enable_filters || false;
     document.getElementById('profileChapterMarkers').checked = profile.chapter_markers !== false;
     document.getElementById('profileHwAccel').checked = profile.hw_accel_enabled || false;
     document.getElementById('profileTwoPass').checked = profile.two_pass;
     document.getElementById('profileIsDefault').checked = profile.is_default;
-    document.getElementById('profileCustomArgs').value = profile.custom_args || '';
+    const customArgsEl = document.getElementById('profileCustomArgs');
+    if (customArgsEl) customArgsEl.value = profile.custom_args || '';
 
     // Populate AI upscale fields
     _fillProfileUpscaleFields(profile);
@@ -973,11 +1038,11 @@ document.getElementById('profileForm').addEventListener('submit', async (e) => {
         container: document.getElementById('profileContainer').value,
         audio_handling: document.getElementById('profileAudioHandling').value,
         subtitle_handling: document.getElementById('profileSubtitleHandling').value,
-        enable_filters: document.getElementById('profileEnableFilters').checked,
+        enable_filters: document.getElementById('profileEnableFilters')?.checked ?? false,
         chapter_markers: document.getElementById('profileChapterMarkers').checked,
         hw_accel_enabled: document.getElementById('profileHwAccel').checked,
         two_pass: document.getElementById('profileTwoPass').checked,
-        custom_args: document.getElementById('profileCustomArgs').value || null,
+        custom_args: document.getElementById('profileCustomArgs')?.value || null,
         is_default: document.getElementById('profileIsDefault').checked,
         // AI upscale settings
         upscale_enabled:       document.getElementById('profileUpscaleEnabled')?.checked ?? false,
@@ -1051,7 +1116,7 @@ async function loadScanRoots() {
                     </div>
                 </div>
                 <div class="flex gap-2">
-                    <button onclick="scanSingleRoot(${r.id})" 
+                    <button onclick="scanSingleRoot(${r.id}, event)" 
                         class="bg-green-600 hover:bg-green-700 px-3 py-1 rounded text-sm">
                         Scan Now
                     </button>
@@ -1074,20 +1139,24 @@ async function showCreateScanRootForm() {
     document.getElementById('scanRootModalTitle').textContent = 'Add Scan Root';
     document.getElementById('scanRootForm').reset();
     document.getElementById('scanRootId').value = '';
-    document.getElementById('scanRootRecursive').checked = true;
+    const recursiveEl = document.getElementById('scanRootRecursive');
+    if (recursiveEl) recursiveEl.checked = true;
     document.getElementById('scanRootEnabled').checked = true;
-    document.getElementById('scanRootShowInStats').checked = true;
+    const showInStatsEl = document.getElementById('scanRootShowInStats');
+    if (showInStatsEl) showInStatsEl.checked = true;
     document.getElementById('scanRootLibraryType').value = 'custom';
     document.getElementById('libraryTypeRecommendation').classList.add('hidden');
 
-    // Reset upscale fields to defaults
-    _fillUpscaleFields({
-        upscale_enabled: false, upscale_trigger_below: 720,
-        upscale_target_height: 1080, upscale_key: 'realesrgan',
-        upscale_model: 'realesrgan-x4plus', upscale_factor: 2,
-    });
+    // Reset upscale fields to defaults if they exist
+    if (typeof _fillUpscaleFields === 'function') {
+        _fillUpscaleFields({
+            upscale_enabled: false, upscale_trigger_below: 720,
+            upscale_target_height: 1080, upscale_key: 'realesrgan',
+            upscale_model: 'realesrgan-x4plus', upscale_factor: 2,
+        });
+    }
     // Collapse the upscale section on new roots
-    const section = document.getElementById('upscaleSection');
+    const section = document.getElementById('upscaleSettingsFields');
     const icon    = document.getElementById('upscaleSectionToggleIcon');
     if (section && !section.classList.contains('hidden')) {
         section.classList.add('hidden');
@@ -1122,10 +1191,12 @@ async function editScanRoot(id) {
     document.getElementById('scanRootPath').value = root.path;
     document.getElementById('scanRootProfile').value = root.profile_id;
     document.getElementById('scanRootLibraryType').value = root.library_type || 'custom';
-    document.getElementById('scanRootRecursive').checked = root.recursive;
+    const recursiveEditEl = document.getElementById('scanRootRecursive');
+    if (recursiveEditEl) recursiveEditEl.checked = root.recursive;
     document.getElementById('scanRootEnabled').checked = root.enabled;
-    document.getElementById('scanRootShowInStats').checked = root.show_in_stats !== false;
-    _fillUpscaleFields(root);
+    const showInStatsEditEl = document.getElementById('scanRootShowInStats');
+    if (showInStatsEditEl) showInStatsEditEl.checked = root.show_in_stats !== false;
+    if (typeof _fillUpscaleFields === 'function') _fillUpscaleFields(root);
     
     document.getElementById('scanRootModal').classList.remove('hidden');
 }
@@ -1142,9 +1213,9 @@ document.getElementById('scanRootForm').addEventListener('submit', async (e) =>
         path:          document.getElementById('scanRootPath').value,
         profile_id:    parseInt(document.getElementById('scanRootProfile').value),
         library_type:  document.getElementById('scanRootLibraryType').value,
-        recursive:     document.getElementById('scanRootRecursive').checked,
+        recursive:     document.getElementById('scanRootRecursive')?.checked ?? true,
         enabled:       document.getElementById('scanRootEnabled').checked,
-        show_in_stats: document.getElementById('scanRootShowInStats').checked,
+        show_in_stats: document.getElementById('scanRootShowInStats')?.checked ?? true,
         // AI upscale settings
         upscale_enabled:        document.getElementById('scanRootUpscaleEnabled')?.checked ?? false,
         upscale_trigger_below:  parseInt(document.getElementById('scanRootUpscaleTrigger')?.value || '720'),
@@ -1180,9 +1251,10 @@ async function deleteScanRoot(id, path) {
     }
 }
 
-async function scanSingleRoot(id) {
+async function scanSingleRoot(id, event) {
     // Find the scan button and disable it
-    const scanBtn = event.target;
+    const scanBtn = event ? event.target : document.querySelector(`button[onclick*="scanSingleRoot(${id})"]`);
+    if (!scanBtn) return;
     const originalText = scanBtn.textContent;
     scanBtn.disabled = true;
     scanBtn.classList.add('opacity-50', 'cursor-not-allowed');
@@ -1407,14 +1479,14 @@ function showCodecGuide() {
 }
 
 // Initialize encoder change listener
-document.addEventListener('DOMContentLoaded', function() {
+// Encoder preset listener - initialized in main DOMContentLoaded
+(function initEncoderListener() {
     const encoderSelect = document.getElementById('profileEncoder');
     if (encoderSelect) {
         encoderSelect.addEventListener('change', updatePresetOptions);
-        // Initialize on load
         updatePresetOptions();
     }
-});
+})();
 
 
 // ============================================================
@@ -1629,24 +1701,24 @@ async function deleteQueueItem(id) {
 
 // Toggle auto-refresh
 function toggleAutoRefresh() {
-    const enabled = document.getElementById('autoRefreshQueue').checked;
+    const checkbox = document.getElementById('autoRefreshQueue');
+    const enabled = checkbox?.checked ?? false;
+    
+    // Always clear existing interval first to prevent stacking
+    if (queueRefreshInterval) {
+        clearInterval(queueRefreshInterval);
+        queueRefreshInterval = null;
+    }
     
     if (enabled) {
         queueRefreshInterval = setInterval(() => {
+            if (document.hidden) return; // Skip when tab not visible
             loadQueue();
         }, 5000);
-    } else {
-        if (queueRefreshInterval) {
-            clearInterval(queueRefreshInterval);
-            queueRefreshInterval = null;
-        }
     }
 }
 
-// Initialize auto-refresh on page load
-if (document.getElementById('autoRefreshQueue').checked) {
-    toggleAutoRefresh();
-}
+// Auto-refresh initialization handled in DOMContentLoaded above
 
 
 // ============================================================
@@ -1817,7 +1889,8 @@ function getSubtitleLabel(strategy) {
 }
 
 // Update help text when audio/subtitle strategy changes
-document.addEventListener('DOMContentLoaded', function() {
+// Audio/subtitle handling listeners - self-initializing
+(function initAudioSubListeners() {
     const audioSelect = document.getElementById('profileAudioHandling');
     if (audioSelect) {
         audioSelect.addEventListener('change', function() {
@@ -1833,7 +1906,7 @@ document.addEventListener('DOMContentLoaded', function() {
             if (help) help.textContent = SUBTITLE_HELP[this.value] || '';
         });
     }
-});
+})();
 
 // Hardware acceleration check
 async function checkHwAccel() {
@@ -2377,7 +2450,8 @@ async function restoreBackup(event) {
 }
 
 async function applyQueuePriority() {
-    const sortBy = document.getElementById('queueSortBy').value;
+    const sortByEl = document.getElementById('queueSortBy');
+    const sortBy = sortByEl?.value || 'default';
     const sortMap = {
         'default':            { sort_by: 'default',            order: 'desc' },
         'file_size':          { sort_by: 'file_size',          order: 'desc' },
@@ -2418,8 +2492,8 @@ async function loadUpscalers() {
         if (!info) return;
         renderUpscalerCards(info);
     } catch (err) {
-        document.getElementById('upscalerStatus').innerHTML =
-            '<p class="text-gray-500">Failed to detect upscalers</p>';
+        const el = document.getElementById('upscalerStatus');
+        if (el) el.innerHTML = '<p class="text-gray-500">Failed to detect upscalers</p>';
     }
 }
 
@@ -2531,130 +2605,8 @@ async function checkUpscalerUpdates() {
 }
 
 // ============================================================
-// WINDOWS REST HOURS (Schedule tab)
-// ============================================================
-
-async function loadWindowsActiveHours() {
-    const avail = document.getElementById('windowsHoursAvailable');
-    const info = document.getElementById('windowsHoursInfo');
-    const toggle = document.getElementById('useWindowsRestHours');
-    if (!avail) return;
-
-    try {
-        const data = await apiRequest('/schedule/windows-active-hours');
-        if (!data || !data.available) {
-            avail.textContent = '(not available on this OS)';
-            if (toggle) toggle.disabled = true;
-            return;
-        }
-        avail.textContent = `(detected: active ${data.active_start}:00‚Äì${data.active_end}:00)`;
-        if (info) {
-            info.textContent = `Encoding will run from ${data.rest_start_str} to ${data.rest_end_str} (outside active hours)`;
-            info.classList.remove('hidden');
-        }
-    } catch (e) {
-        avail.textContent = '(not available)';
-        if (toggle) toggle.disabled = true;
-    }
-}
-
-function toggleWindowsHours() {
-    const useWin = document.getElementById('useWindowsRestHours');
-    const manualDiv = document.getElementById('manualTimeWindow');
-    if (!useWin || !manualDiv) return;
-    if (useWin.checked) {
-        manualDiv.style.opacity = '0.4';
-        manualDiv.style.pointerEvents = 'none';
-    } else {
-        manualDiv.style.opacity = '1';
-        manualDiv.style.pointerEvents = '';
-    }
-}
-
-// Override saveSchedule to include new fields
-const _originalSaveSchedule = typeof saveSchedule === 'function' ? saveSchedule : null;
-async function saveSchedule() {
-    const useWinEl = document.getElementById('useWindowsRestHours');
-    const config = {
-        enabled: document.getElementById('scheduleEnabled').checked,
-        days_of_week: Array.from(selectedDays).sort().join(','),
-        start_time: document.getElementById('startTime').value,
-        end_time: document.getElementById('endTime').value,
-        timezone: 'local',
-        use_windows_rest_hours: useWinEl ? useWinEl.checked : false,
-        max_concurrent_jobs: 1,
-    };
-    const result = await apiRequest('/schedule', {
-        method: 'POST',
-        body: JSON.stringify(config)
-    });
-    if (result) {
-        const msgEl = document.getElementById('scheduleMessage');
-        if (msgEl) {
-            msgEl.textContent = '‚úì Schedule saved successfully';
-            msgEl.className = 'mt-4 p-3 bg-green-900/50 border border-green-700 rounded text-green-300';
-            msgEl.classList.remove('hidden');
-            setTimeout(() => msgEl.classList.add('hidden'), 3000);
-        }
-        loadSchedule();
-    }
-}
-
-// Override loadSchedule to include Windows hours fields
-const _origLoadSchedule = window._loadScheduleOriginal || null;
-async function loadSchedule() {
-    const schedule = await apiRequest('/schedule');
-    if (!schedule) return;
-    const config = schedule.config || {};
-
-    const enabledEl = document.getElementById('scheduleEnabled');
-    if (enabledEl) enabledEl.checked = config.enabled;
-
-    if (typeof selectedDays !== 'undefined') {
-        selectedDays = new Set((config.days_of_week || '0,1,2,3,4,5,6').split(',').map(Number));
-        if (typeof updateDayButtons === 'function') updateDayButtons();
-    }
-
-    const startEl = document.getElementById('startTime');
-    const endEl = document.getElementById('endTime');
-    if (startEl) startEl.value = config.start_time || '22:00';
-    if (endEl) endEl.value = config.end_time || '06:00';
-
-    const useWinEl = document.getElementById('useWindowsRestHours');
-    if (useWinEl) {
-        useWinEl.checked = config.use_windows_rest_hours || false;
-        toggleWindowsHours();
-    }
-
-    // Status indicators
-    const statusEl = document.getElementById('scheduleStatus');
-    if (statusEl) {
-        statusEl.textContent = config.enabled ? '‚úì Enabled' : '‚úó Disabled';
-        statusEl.className = config.enabled ? 'ml-2 font-medium text-green-400' : 'ml-2 font-medium text-gray-400';
-    }
-    const withinEl = document.getElementById('withinWindow');
-    if (withinEl) {
-        withinEl.textContent = schedule.within_schedule ? '‚úì Yes' : '‚úó No';
-        withinEl.className = schedule.within_schedule ? 'ml-2 font-medium text-green-400' : 'ml-2 font-medium text-gray-400';
-    }
-    const overrideEl = document.getElementById('manualOverride');
-    if (overrideEl) {
-        overrideEl.textContent = schedule.manual_override ? '‚úì Active' : '‚úó Inactive';
-        overrideEl.className = schedule.manual_override ? 'ml-2 font-medium text-yellow-400' : 'ml-2 font-medium text-gray-400';
-    }
-
-    // Load Windows hours info if on this tab
-    loadWindowsActiveHours();
-}
-
-// ============================================================
-// SHOW MESSAGE HELPER (if not already defined)
+// (Dead schedule override code removed ‚Äî using primary definitions)
 // ============================================================
-if (typeof showMessage !== 'function') {
-    function showMessage(msg, type = 'info') {
-        console.log(`[${type.toUpperCase()}] ${msg}`);
-    }
-}
 
 
 // ============================================================
@@ -3128,7 +3080,7 @@ const _UPSCALER_MODELS = {
 };
 
 function toggleUpscaleSection() {
-    const section = document.getElementById('upscaleSection');
+    const section = document.getElementById('upscaleSettingsFields');
     const icon    = document.getElementById('upscaleSectionToggleIcon');
     const hidden  = section.classList.toggle('hidden');
     icon.textContent = hidden ? '‚ñ∂' : '‚ñº';
@@ -3280,3 +3232,7 @@ function handleConnectionTypeChange() {
         }
     }
 }
+
+// Function aliases for HTML compatibility
+const showCreateRootForm = showCreateScanRootForm;
+const showCreateConnectionForm = showAddConnectionModal;
diff --git a/web/templates/index.html b/web/templates/index.html
index ae3aaac..01bab40 100644
--- a/web/templates/index.html
+++ b/web/templates/index.html
@@ -136,7 +136,14 @@
                         </div>
                         <div class="flex items-center gap-2">
                             <label class="text-xs text-muted">Search:</label>
-                            <input type="text" id="queueSearchInput" class="form-input" style="width:200px;padding:5px 10px" placeholder="Filter by filename..." oninput="filterQueue()">
+                            <input type="text" id="queueSearchInput" class="form-input" style="width:200px;padding:5px 10px" placeholder="Filter by filename..." oninput="debouncedFilterQueue()">
+                        </div>
+                        <div class="flex items-center gap-2">
+                            <label class="text-xs text-muted">Priority:</label>
+                            <select id="queueSortBy" class="form-select" style="width:auto;padding:5px 30px 5px 10px">
+                                <option value="default">Default</option><option value="file_size">File Size</option><option value="estimated_savings">Est. Savings</option><option value="filename">Filename</option>
+                            </select>
+                            <button class="btn btn-secondary btn-xs" onclick="applyQueuePriority()">Apply</button>
                         </div>
                         <div style="margin-left:auto" class="flex items-center gap-2">
                             <label class="form-checkbox"><input type="checkbox" id="selectAllQueue" onchange="toggleSelectAll()"><span class="text-xs">Select All</span></label>
@@ -161,6 +168,15 @@
                         <tbody id="queueBody"><tr><td colspan="8" class="text-center text-muted" style="padding:40px">Loading queue...</td></tr></tbody>
                     </table>
                 </div>
+                <!-- Bulk actions floating bar -->
+                <div id="bulkActionsBar" class="hidden" style="position:sticky;bottom:0;left:0;right:0;background:var(--bg-card);border-top:1px solid var(--border);padding:10px 16px;display:flex;align-items:center;gap:12px;z-index:10">
+                    <span class="text-sm"><strong id="bulkSelectedCount">0</strong> items selected</span>
+                    <button class="btn btn-secondary btn-xs" onclick="bulkAction('delete')">üóëÔ∏è Delete</button>
+                    <button class="btn btn-secondary btn-xs" onclick="bulkAction('retry')">üîÑ Retry</button>
+                    <button class="btn btn-secondary btn-xs" onclick="bulkAction('pause')">‚è∏ Pause</button>
+                    <button class="btn btn-secondary btn-xs" onclick="bulkAction('resume')">‚ñ∂ Resume</button>
+                    <button class="btn btn-xs" style="margin-left:auto;color:var(--text-muted)" onclick="clearSelection()">‚úï Clear</button>
+                </div>
             </div>
 
             <!-- PROFILES TAB -->
@@ -211,16 +227,31 @@
                         <label class="form-checkbox"><input type="checkbox" id="statsHideSensitive" onchange="loadStatistics()"><span class="text-xs">Hide sensitive paths</span></label>
                     </div>
                 </div>
-                <div class="stat-grid mb-4" id="statsCards">
-                    <div class="stat-card"><div class="stat-label">Total Encoded</div><div class="stat-value cyan" id="statsTotalFiles">0</div></div>
-                    <div class="stat-card"><div class="stat-label">Space Saved</div><div class="stat-value green" id="statsTotalSaved">0 GB</div></div>
-                    <div class="stat-card"><div class="stat-label">Avg. Reduction</div><div class="stat-value blue" id="statsAvgReduction">0%</div></div>
-                    <div class="stat-card"><div class="stat-label">Avg. Speed</div><div class="stat-value purple" id="statsAvgSpeed">0 FPS</div></div>
+                <div class="stat-grid mb-4" id="statsCards" style="grid-template-columns:repeat(auto-fill,minmax(160px,1fr))">
+                    <div class="stat-card"><div class="stat-label">Total Encoded</div><div class="stat-value cyan" id="statTotalFiles">0</div></div>
+                    <div class="stat-card"><div class="stat-label">Original Size</div><div class="stat-value blue" id="statOriginalSize">0 GB</div></div>
+                    <div class="stat-card"><div class="stat-label">New Size</div><div class="stat-value purple" id="statNewSize">0 GB</div></div>
+                    <div class="stat-card"><div class="stat-label">Space Saved</div><div class="stat-value green" id="statSaved">0 GB</div></div>
+                    <div class="stat-card"><div class="stat-label">Avg. Reduction</div><div class="stat-value yellow" id="statAvgPct">0%</div></div>
+                    <div class="stat-card"><div class="stat-label">Avg. Encode Time</div><div class="stat-value purple" id="statAvgTime">‚Äî</div></div>
                 </div>
                 <div class="grid grid-2 gap-4">
                     <div class="card"><div class="card-title mb-3">Daily Activity</div><div id="dailyChart" style="min-height:200px" class="text-muted text-sm text-center">No data</div></div>
                     <div class="card"><div class="card-title mb-3">Codec Distribution</div><div id="codecChart" style="min-height:200px" class="text-muted text-sm text-center">No data</div></div>
                 </div>
+                <div class="grid grid-2 gap-4 mt-4">
+                    <div class="card"><div class="card-title mb-3">Codec Breakdown</div><div id="codecBreakdown" class="space-y-3 text-muted text-sm">No data</div></div>
+                    <div class="card"><div class="card-title mb-3">Recent History</div><div id="recentHistory" class="space-y-2 text-muted text-sm" style="max-height:400px;overflow-y:auto">No encoding history yet</div></div>
+                </div>
+                <!-- Upscaler & Reprobe Status -->
+                <div class="grid grid-2 gap-4 mt-4">
+                    <div class="card"><div class="card-title mb-3">AI Upscaler Status</div><div id="upscalerStatus" class="text-sm text-muted">Checking...</div></div>
+                    <div class="card">
+                        <div class="card-title mb-3">File Reprobe</div>
+                        <p class="text-xs text-muted mb-3">Re-scan all completed files to update codec/size metadata</p>
+                        <button id="reprobeBtn" class="btn btn-secondary btn-sm" onclick="reprobeQueue()"><span id="reproBtnIcon">üîÑ</span> <span id="reproBtnText">Reprobe All</span></button>
+                    </div>
+                </div>
             </div>
 
             <!-- LOGS TAB -->
@@ -301,16 +332,27 @@
                         <div class="card-title mb-3">System</div>
                         <label class="form-checkbox"><input type="checkbox" id="settingsThrottle" checked><span>Enable automatic resource throttling</span></label>
                         <div class="divider"></div>
+                        <div class="card-title mb-3">Resource Thresholds</div>
+                        <div class="grid grid-2 gap-3">
+                            <div class="form-group"><label class="form-label">CPU %</label><input type="number" id="cpuThreshold" class="form-input" value="90" min="10" max="100"></div>
+                            <div class="form-group"><label class="form-label">Memory %</label><input type="number" id="memoryThreshold" class="form-input" value="85" min="10" max="100"></div>
+                            <div class="form-group"><label class="form-label">GPU %</label><input type="number" id="gpuThreshold" class="form-input" value="90" min="10" max="100"></div>
+                            <div class="form-group"><label class="form-label">Nice Level</label><input type="number" id="niceLevel" class="form-input" value="10" min="0" max="19"></div>
+                        </div>
+                        <button class="btn btn-primary btn-sm mt-2" onclick="saveResourceSettings()">Save Thresholds</button>
+                        <div class="divider"></div>
                         <div class="card-title mb-3">Data Management</div>
                         <div class="flex gap-2">
                             <button class="btn btn-secondary btn-sm" onclick="downloadBackup()">‚¨áÔ∏è Backup</button>
                             <button class="btn btn-secondary btn-sm" onclick="document.getElementById('restoreFile').click()">‚¨ÜÔ∏è Restore</button>
                             <input type="file" id="restoreFile" accept=".db,.sqlite" class="hidden" onchange="restoreBackup(event)">
                         </div>
+                        <div id="restoreFileName" class="text-xs text-muted mt-2 hidden"></div>
+                        <div id="restoreStatus" class="text-xs mt-1 hidden"></div>
                         <div class="divider"></div>
                         <div class="card-title mb-3">Health Check</div>
                         <div id="healthStatus" class="text-sm text-muted">Click to check system health</div>
-                        <button class="btn btn-secondary btn-sm mt-2" onclick="checkHealth()">ü©∫ Run Health Check</button>
+                        <button class="btn btn-secondary btn-sm mt-2" onclick="loadHealth()">ü©∫ Run Health Check</button>
                     </div>
                 </div>
             </div>
@@ -392,21 +434,34 @@
                         </div>
                         <label class="form-checkbox mt-2"><input type="checkbox" id="profileChapterMarkers" checked><span>Preserve chapter markers</span></label>
                         <label class="form-checkbox mt-2"><input type="checkbox" id="profileWebOptimized"><span>Web-optimized</span></label>
+                        <label class="form-checkbox mt-2"><input type="checkbox" id="profileEnableFilters"><span>Enable video filters</span></label>
+                        <div class="form-group mt-3">
+                            <label class="form-label">Custom HandBrake Arguments</label>
+                            <textarea id="profileCustomArgs" class="form-input" rows="2" placeholder="e.g. --encoder-tune animation" style="font-family:monospace;font-size:12px"></textarea>
+                            <div class="form-hint">Additional CLI flags passed directly to HandBrakeCLI</div>
+                        </div>
                     </div>
 
                     <!-- AI Upscaling Section -->
-                    <button type="button" class="collapse-toggle mt-3" onclick="toggleCollapse('upscaleSection', this)"><span class="chevron">‚ñ∂</span> AI Upscaling</button>
-                    <div id="upscaleSection" class="collapse-content">
-                        <label class="form-checkbox"><input type="checkbox" id="profileUpscaleEnabled"><span>Enable AI upscaling</span></label>
-                        <div class="grid grid-3 gap-3 mt-3">
-                            <div class="form-group"><label class="form-label">Trigger Below</label><input type="number" id="profileUpscaleTrigger" class="form-input" value="720" min="240" max="2160"></div>
-                            <div class="form-group"><label class="form-label">Target Height</label><input type="number" id="profileUpscaleTarget" class="form-input" value="1080" min="480" max="4320"></div>
-                            <div class="form-group"><label class="form-label">Upscaler</label>
-                                <select id="profileUpscaleKey" class="form-select"><option value="realesrgan">Real-ESRGAN</option><option value="waifu2x">Waifu2x</option><option value="realcugan">Real-CUGAN</option></select>
+                    <button type="button" class="collapse-toggle mt-3" onclick="toggleCollapse('profileUpscaleSection', this)"><span class="chevron" id="profileUpscaleToggleIcon">‚ñ∂</span> AI Upscaling <span id="profileUpscaleEnabledBadge" class="hidden" style="color:var(--green);font-size:11px;margin-left:6px">‚óè ON</span></button>
+                    <div id="profileUpscaleSection" class="collapse-content">
+                        <label class="form-checkbox"><input type="checkbox" id="profileUpscaleEnabled" onchange="document.getElementById('profileUpscaleEnabledBadge').classList.toggle('hidden', !this.checked)"><span>Enable AI upscaling</span></label>
+                        <div id="profileUpscaleFields" class="mt-3">
+                            <div class="grid grid-3 gap-3">
+                                <div class="form-group"><label class="form-label">Trigger Below</label><input type="number" id="profileUpscaleTrigger" class="form-input" value="720" min="240" max="2160"></div>
+                                <div class="form-group"><label class="form-label">Target Height</label><input type="number" id="profileUpscaleTarget" class="form-input" value="1080" min="480" max="4320"></div>
+                                <div class="form-group"><label class="form-label">Upscaler</label>
+                                    <select id="profileUpscaleKey" class="form-select"><option value="realesrgan">Real-ESRGAN</option><option value="waifu2x">Waifu2x</option><option value="realcugan">Real-CUGAN</option></select>
+                                </div>
+                            </div>
+                            <div class="grid grid-2 gap-3 mt-2">
+                                <div class="form-group"><label class="form-label">Model</label>
+                                    <select id="profileUpscaleModel" class="form-select"><option value="realesrgan-x4plus">realesrgan-x4plus</option><option value="realesrgan-x4plus-anime">realesrgan-x4plus-anime</option><option value="realesr-animevideov3">realesr-animevideov3</option></select>
+                                </div>
+                                <div class="form-group"><label class="form-label">Scale Factor</label>
+                                    <select id="profileUpscaleFactor" class="form-select"><option value="2">2√ó</option><option value="3">3√ó</option><option value="4" selected>4√ó</option></select>
+                                </div>
                             </div>
-                        </div>
-                        <div class="form-group"><label class="form-label">Model</label>
-                            <select id="profileUpscaleModel" class="form-select"><option value="realesrgan-x4plus">realesrgan-x4plus</option><option value="realesrgan-x4plus-anime">realesrgan-x4plus-anime</option><option value="realesr-animevideov3">realesr-animevideov3</option></select>
                         </div>
                     </div>
                 </form>
@@ -436,6 +491,29 @@
                     </div>
                     <div id="libraryTypeRecommendation" class="card card-compact hidden mt-2" style="background:var(--info-dim);border-color:rgba(52,152,219,0.15)"></div>
                     <label class="form-checkbox mt-3"><input type="checkbox" id="scanRootEnabled" checked><span>Enabled</span></label>
+                    <label class="form-checkbox mt-2"><input type="checkbox" id="scanRootRecursive" checked><span>Scan subdirectories recursively</span></label>
+                    <label class="form-checkbox mt-2"><input type="checkbox" id="scanRootShowInStats" checked><span>Show in statistics</span></label>
+                    <!-- Scan Root Upscale Override -->
+                    <button type="button" class="collapse-toggle mt-3" onclick="toggleCollapse('upscaleSettingsFields', this)"><span class="chevron" id="upscaleSectionToggleIcon">‚ñ∂</span> AI Upscale Override <span id="upscaleEnabledBadge" class="hidden" style="color:var(--green);font-size:11px;margin-left:6px">‚óè ON</span></button>
+                    <div id="upscaleSettingsFields" class="collapse-content">
+                        <div class="form-hint mb-2">Override the profile's upscale settings for this library</div>
+                        <label class="form-checkbox"><input type="checkbox" id="scanRootUpscaleEnabled" onchange="document.getElementById('upscaleEnabledBadge').classList.toggle('hidden', !this.checked)"><span>Enable AI upscaling</span></label>
+                        <div class="grid grid-3 gap-3 mt-3">
+                            <div class="form-group"><label class="form-label">Trigger Below</label><input type="number" id="scanRootUpscaleTrigger" class="form-input" value="720" min="240" max="2160"></div>
+                            <div class="form-group"><label class="form-label">Target Height</label><input type="number" id="scanRootUpscaleTarget" class="form-input" value="1080" min="480" max="4320"></div>
+                            <div class="form-group"><label class="form-label">Upscaler</label>
+                                <select id="scanRootUpscaleKey" class="form-select"><option value="realesrgan">Real-ESRGAN</option><option value="waifu2x">Waifu2x</option><option value="realcugan">Real-CUGAN</option></select>
+                            </div>
+                        </div>
+                        <div class="grid grid-2 gap-3 mt-2">
+                            <div class="form-group"><label class="form-label">Model</label>
+                                <select id="scanRootUpscaleModel" class="form-select"><option value="realesrgan-x4plus">realesrgan-x4plus</option><option value="realesrgan-x4plus-anime">realesrgan-x4plus-anime</option><option value="realesr-animevideov3">realesr-animevideov3</option></select>
+                            </div>
+                            <div class="form-group"><label class="form-label">Scale Factor</label>
+                                <select id="scanRootUpscaleFactor" class="form-select"><option value="2">2√ó</option><option value="3">3√ó</option><option value="4" selected>4√ó</option></select>
+                            </div>
+                        </div>
+                    </div>
                 </form>
             </div>
             <div class="modal-footer"><button class="btn btn-secondary" onclick="closeScanRootModal()">Cancel</button><button class="btn btn-primary" onclick="document.getElementById('scanRootForm').requestSubmit()">Save</button></div>
@@ -472,18 +550,22 @@
                     <input type="hidden" id="connectionId">
                     <div class="grid grid-2 gap-3">
                         <div class="form-group"><label class="form-label">Name</label><input type="text" id="connectionName" class="form-input" required placeholder="My Sonarr"></div>
-                        <div class="form-group"><label class="form-label">Type</label><select id="connectionType" class="form-select"><option value="sonarr">Sonarr</option><option value="radarr">Radarr</option><option value="stash">Stash</option></select></div>
+                        <div class="form-group"><label class="form-label">Type</label><select id="connectionAppType" class="form-select" onchange="handleConnectionTypeChange()"><option value="sonarr">Sonarr</option><option value="radarr">Radarr</option><option value="stash">Stash</option></select></div>
                     </div>
-                    <div class="form-group"><label class="form-label">URL</label><input type="url" id="connectionUrl" class="form-input" required placeholder="http://localhost:8989"></div>
-                    <div class="form-group"><label class="form-label">API Key</label><input type="password" id="connectionApiKey" class="form-input" required></div>
+                    <div class="form-group"><label class="form-label">URL</label><input type="url" id="connectionUrl" class="form-input" required placeholder="http://localhost:8989"><div class="form-hint" id="connectionUrlHint"></div></div>
+                    <div class="form-group"><label class="form-label">API Key</label><input type="password" id="connectionApiKey" class="form-input" required><div class="form-hint" id="connectionKeyHint"></div></div>
+                    <div class="form-group"><label class="form-label">Scan Root</label><select id="connectionScanRoot" class="form-select"><option value="">‚Äî None (manual only) ‚Äî</option></select></div>
                     <label class="form-checkbox mt-3"><input type="checkbox" id="connectionEnabled" checked><span>Enabled</span></label>
+                    <label class="form-checkbox mt-2"><input type="checkbox" id="connectionShowInStats" checked><span>Show in statistics</span></label>
+                    <div class="form-hint mt-2 hidden" id="connectionPrivacyNote"></div>
+                    <div id="connectionTestResult" class="hidden mt-3 p-3 rounded text-sm" style="background:var(--bg-overlay)"></div>
                 </form>
             </div>
             <div class="modal-footer">
                 <button class="btn btn-secondary btn-sm" onclick="testConnection()">üß™ Test</button>
                 <div style="flex:1"></div>
                 <button class="btn btn-secondary" onclick="closeConnectionModal()">Cancel</button>
-                <button class="btn btn-primary" onclick="document.getElementById('connectionForm').requestSubmit()">Save</button>
+                <button id="connectionSaveBtn" class="btn btn-primary" onclick="document.getElementById('connectionForm').requestSubmit()">Save</button>
             </div>
         </div>
     </div>
